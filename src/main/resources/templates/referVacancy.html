<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>Insert title here</title>


	<style type="text/css">
		#calendar {
			display: flex;
			flex-wrap: wrap;
		}

		section {
			margin: 10px;
		}

		h1 {
			font-size: 18px;
		}

		table {
			border-spacing: 0;
			border-collapse: collapse;
		}

		td {
			border: 1px solid #ddd;
			padding: 5px;
			text-align: center;
		}

		td:first-child {
			color: red;
		}

		td:last-child {
			color: royalblue;
		}

		td.is-disabled {
			color: #ccc;
		}

		td.is-today {
			background-color: #ffa500;
		}
	</style>
</head>

<body>
	<body th:with="var=${@helper.publicMethod()}">
	<form action="#" th:action="@{/referVacancyDate}"  method="post">
		<input id="prev" type="submit" value="戻る" />
	</form>
	<div th:text="${@helper.publicMethod()}"></div>

	
	
	<button id="next" type="button">次の月</button>
	<div id="calendar"></div>
	
	<script type="text/javascript" th:inline="javascript">
	
	var test = [[${var}]];
	console.log(test)
	
	function moveCalendar(e) {
		document.querySelector('#calendar').innerHTML = ''

		if (e.target.id === 'prev') {
			month--

			if (month < 1) {
				year--
				month = 12
			}
		}

		if (e.target.id === 'next') {
			month++

			if (month > 12) {
				year++
				month = 1
			}
		}

		showCalendar(year, month)
	}

		const weeks = ['日', '月', '火', '水', '木', '金', '土']
		const date = new Date()
		let year = date.getFullYear()
		let month = date.getMonth() + 1

		function showCalendar(year, month) {
			const calendarHtml = createCalendar(year, month)
			const sec = document.createElement('section')
			sec.innerHTML = calendarHtml
			document.querySelector('#calendar').appendChild(sec)

			if (month >= 12) {
				year++
				month = 1
			}
		}

		function createCalendar(year, month) {
			const startDate = new Date(year, month - 1, 1) // 月の最初の日を取得
			const endDate = new Date(year, month, 0) // 月の最後の日を取得
			const endDayCount = endDate.getDate() // 月の末日
			const lastMonthEndDate = new Date(year, month - 1, 0) // 前月の最後の日の情報
			const lastMonthendDayCount = lastMonthEndDate.getDate() // 前月の末日
			const startDay = startDate.getDay() // 月の最初の日の曜日を取得
			let dayCount = 1 // 日にちのカウント
	        let calendarHtml = '' // HTMLを組み立てる変数
	      
	        var roomStatements = /*[[${roomStatements}]]*/
	        
			calendarHtml += '<h1>' + year + '/' + month + '</h1>'
      		calendarHtml += '<table>'

      		// 曜日の行を作成
			for (let i = 0; i < weeks.length; i++) {
				calendarHtml += '<td>' + weeks[i] + '</td>'
			}

			for (let w = 0; w < 6; w++) {
				calendarHtml += '<tr>'

				for (let d = 0; d < 7; d++) {
					if (w == 0 && d < startDay) {
						// 1行目で1日の曜日の前
						let num = lastMonthendDayCount - startDay + d + 1
						calendarHtml += '<td class="is-disabled">' + num + '</td>'
					} else if (dayCount > endDayCount) {
						// 末尾の日数を超えた
						let num = dayCount - endDayCount
						calendarHtml += '<td class="is-disabled">' + num + '</td>'
						dayCount++
					} else {
						var todayYMFlag = date.getFullYear() === year && date.getMonth() + 1 === month ? true : false; // 本日の年と月が表示されるカレンダーと同じか判定
						var addClass = todayYMFlag && dayCount === date.getDate() ? 'is-today' : '';
						calendarHtml += `<td class=${addClass}><font size="-1">${dayCount}<br></font><div>${test}<div></td>`
						dayCount++
					}
				}
				calendarHtml += '</tr>'
			}
			calendarHtml += '</table>'

			return calendarHtml
		}

		


		document.getElementById('prev').addEventListener('click', moveCalendar)
		document.getElementById('next').addEventListener('click', moveCalendar)

		showCalendar(year, month)
	</script>
	
	
	
</body>

</html>